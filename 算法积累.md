#算法的积累

> 咳咳，算法呢是考核一个程序员的核心标准，如果你不会算法那永远只能搬砖！所以多多少少我们也要累积一点算法的，有了NB的算法，我们才能实现NB的功能！

***

## 一个日历的算法

> 最近实习公司里用的都是React，但是更多的时间还要维护老的项目，用的老的掉渣的SeaJs、JQ和Es3的语法（为了兼容性。。。）感觉Vue学了不用会生疏，ES6的各种语法糖让我用的也很爽。
最近打算做一个vue-worktile。worktile不知道的自己百度下吧，其实就像是公司里给你安排任务的一个系统。
安排任务最重要的不就是排期嘛，就是得有个日历，但是日历怎么生成呢？什么闰年啦，大小月啦，真是麻烦，这次我就记录下一个便捷取巧的日历算法吧！

>2017.6.24

#### 首先我们要做一个像下面一样的日历（2017.6）

<table>
    <thead>
    <tr>
        <th>周日</th>
        <th>周一</th>
        <th>周二</th>
        <th>周三</th>
        <th>周四</th>
        <th>周五</th>
        <th>周六</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>28</td>
        <td>29</td>
        <td>30</td>
        <td>31</td>
        <td>1</td>
        <td>2</td>
        <td>3</td>
    </tr>
    <tr>
        <td>4</td>
        <td>5</td>
        <td>6</td>
        <td>7</td>
        <td>8</td>
        <td>9</td>
        <td>10</td>
    </tr>
    <tr>
        <td>11</td>
        <td>12</td>
        <td>13</td>
        <td>14</td>
        <td>15</td>
        <td>16</td>
        <td>17</td>
    </tr>
    <tr>
        <td>18</td>
        <td>19</td>
        <td>20</td>
        <td>21</td>
        <td>22</td>
        <td>23</td>
        <td>24</td>
    </tr>
    <tr>
        <td>25</td>
        <td>26</td>
        <td>27</td>
        <td>28</td>
        <td>29</td>
        <td>30</td>
        <td>1</td>
    </tr>
    </tbody>
</table>

#### 我们分析下这个日历怎么做：

- 首先我们得知道这个月有几天
- 其次我们得知道这个月的第一天是星期几
- 我们还需要知道上个月的最后一天是几号（30？31?万一是闰年呢？）

#### 日历分析完了，那我们开撸吧！

- 首先我们获取一下这个月的第一天是星期几吧，这个简单容易实现

```javascript
//获取这个月的第一天是星期几，js需要月份-1
let theMonthFirstDay = new Date(2017, 6 - 1, 1).getDay();
```
需要注意的就是js里 `new Date(年份，月份-1，1号)` 月份要记得-1 `getDay()`获取星期几

- 那一个月有几天如何确定呢？

一开始我想的是1，3，5，7，9，12就是31天，4，6，8，10就是30天，闰年单独看。
但是太麻烦了！Too young ! Too Naive！

**所以就有了下面这个简单取巧的算法**

```javascript
//Vue的写法，省略了Data
//算法：这个月的最后一天就是下个月的第一天-1ms,还需要考虑月份为12的时候年份+1
let y = this.month === 12 ? this.year + 1 : this.year; //下月所在的年份
let m = this.month === 12 ? 1 : this.month;  //如果是12月，下月就是1月
let theMonthDays = new Date(new Date(y, m, 1) - 1).getDate(); //日期对象-常数得到一个时间戳再newDate
```
**核心算法**就是：  
这个月的最后一天就是下个月的第一天减去1毫秒，就可以获得这个月最后一天的时间戳了！  
获得时间戳后，再`new Date(时间戳).getDate()`就可以知道这个月最后一天是30还是31，28还是29，都不用判断是不是闰年了！

需要注意的是：

- 要当心如果本月是12月，那下月是1月要做处理
- 同样月份做了处理，如果是12月，下月的年份也要记得+1
- new Date(年，月，日) 会得到类似这样的一个日期对象`Thu Jun 01 2017 00:00:00 GMT+0800 (CST)`，这个对象减去一个常数会得到一个时间戳，
列如`new Date(2017,5,1)-1`会得到`1496246399999`这样的一个时间戳，这个时间戳再放入`new Date(1496246399999)`会得到`Wed May 31 2017 23:59:59 GMT+0800 (CST)`
此时`getDate()`一下就可以获得具体是几号了`new Date(1496246399999).getDate()`得到`31`号

